{"ast":null,"code":"import React, { useContext, useMemo } from 'react';\nimport { AppContext } from './AppContext';\n;\nexport function connect({\n  mapStateToProps = () => ({}),\n  mapDispatchToProps = {},\n  component\n}) {\n  var _s = $RefreshSig$();\n\n  const Connect = ownProps => {\n    _s();\n\n    const context = useContext(AppContext);\n    const dispatchFuncs = useMemo(() => {\n      const dispatchFuncs = {};\n      Object.keys(mapDispatchToProps).forEach(key => {\n        const oldFunc = mapDispatchToProps[key];\n\n        const newFunc = (...args) => {\n          const dispatchFunc = oldFunc(...args);\n\n          if (typeof dispatchFunc === 'object') {\n            context.dispatch(dispatchFunc);\n          } else {\n            const result = dispatchFunc(context.dispatch);\n\n            if (typeof result === 'object' && result.then) {\n              result.then(dispatchObject => {\n                if (dispatchObject && dispatchObject.type) {\n                  context.dispatch(dispatchObject);\n                }\n              });\n            }\n          }\n        };\n\n        dispatchFuncs[key] = newFunc;\n      });\n      return dispatchFuncs; // eslint-disable-next-line\n    }, [mapDispatchToProps]);\n    const props = useMemo(() => {\n      return Object.assign({}, ownProps, mapStateToProps(context.state, ownProps), dispatchFuncs); // eslint-disable-next-line\n    }, [ownProps, context.state]);\n    return /*#__PURE__*/React.createElement(component, props);\n  };\n\n  _s(Connect, \"4Kdqux1uDRr/enlsUiSpGsn1yB0=\");\n\n  return /*#__PURE__*/React.memo(Connect);\n}","map":{"version":3,"sources":["/Users/elyotech/Downloads/v9/src/data/connect.tsx"],"names":["React","useContext","useMemo","AppContext","connect","mapStateToProps","mapDispatchToProps","component","Connect","ownProps","context","dispatchFuncs","Object","keys","forEach","key","oldFunc","newFunc","args","dispatchFunc","dispatch","result","then","dispatchObject","type","props","assign","state","createElement","memo"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,UAAhB,EAA4BC,OAA5B,QAA2C,OAA3C;AACA,SAASC,UAAT,QAA2B,cAA3B;AAQC;AAED,OAAO,SAASC,OAAT,CAA2E;AAAEC,EAAAA,eAAe,GAAG,OAAO,EAAP,CAApB;AAA+CC,EAAAA,kBAAkB,GAAG,EAApE;AAA0FC,EAAAA;AAA1F,CAA3E,EAA6Q;AAAA;;AAElR,QAAMC,OAAO,GAAIC,QAAD,IAAyB;AAAA;;AACvC,UAAMC,OAAO,GAAGT,UAAU,CAACE,UAAD,CAA1B;AAEA,UAAMQ,aAAa,GAAGT,OAAO,CAAC,MAAM;AAClC,YAAMS,aAAqC,GAAG,EAA9C;AACAC,MAAAA,MAAM,CAACC,IAAP,CAAYP,kBAAZ,EAAgCQ,OAAhC,CAAyCC,GAAD,IAAS;AAC/C,cAAMC,OAAO,GAAIV,kBAAD,CAA4BS,GAA5B,CAAhB;;AACA,cAAME,OAAO,GAAG,CAAC,GAAGC,IAAJ,KAAkB;AAChC,gBAAMC,YAAY,GAAGH,OAAO,CAAC,GAAGE,IAAJ,CAA5B;;AACA,cAAI,OAAOC,YAAP,KAAwB,QAA5B,EAAsC;AACpCT,YAAAA,OAAO,CAACU,QAAR,CAAiBD,YAAjB;AACD,WAFD,MAEO;AACL,kBAAME,MAAM,GAAGF,YAAY,CAACT,OAAO,CAACU,QAAT,CAA3B;;AACA,gBAAI,OAAOC,MAAP,KAAkB,QAAlB,IAA8BA,MAAM,CAACC,IAAzC,EAA+C;AAC7CD,cAAAA,MAAM,CAACC,IAAP,CAAaC,cAAD,IAAqC;AAC/C,oBAAIA,cAAc,IAAIA,cAAc,CAACC,IAArC,EAA2C;AACzCd,kBAAAA,OAAO,CAACU,QAAR,CAAiBG,cAAjB;AACD;AACF,eAJD;AAKD;AACF;AACF,SAdD;;AAeAZ,QAAAA,aAAa,CAACI,GAAD,CAAb,GAAqBE,OAArB;AACD,OAlBD;AAmBA,aAAON,aAAP,CArBkC,CAsBlC;AACD,KAvB4B,EAuB1B,CAACL,kBAAD,CAvB0B,CAA7B;AA0BA,UAAMmB,KAAK,GAAGvB,OAAO,CAAC,MAAM;AAC1B,aAAOU,MAAM,CAACc,MAAP,CAAc,EAAd,EAAkBjB,QAAlB,EAA4BJ,eAAe,CAACK,OAAO,CAACiB,KAAT,EAAgBlB,QAAhB,CAA3C,EAAsEE,aAAtE,CAAP,CAD0B,CAE1B;AACD,KAHoB,EAGlB,CAACF,QAAD,EAAWC,OAAO,CAACiB,KAAnB,CAHkB,CAArB;AAKA,wBAAO3B,KAAK,CAAC4B,aAAN,CAA+BrB,SAA/B,EAA0CkB,KAA1C,CAAP;AACD,GAnCD;;AAFkR,KAE5QjB,OAF4Q;;AAsClR,sBAAOR,KAAK,CAAC6B,IAAN,CAAWrB,OAAX,CAAP;AACD","sourcesContent":["import React, { useContext, useMemo } from 'react';\r\nimport { AppContext } from './AppContext';\r\nimport { DispatchObject } from './types';\r\nimport { AppState } from './state';\r\n\r\ninterface ConnectParams<TOwnProps, TStateProps, TDispatchProps> {\r\n  mapStateToProps?: (state: AppState, props: TOwnProps) => TStateProps,\r\n  mapDispatchToProps?: TDispatchProps,\r\n  component: React.ComponentType<any>\r\n};\r\n\r\nexport function connect<TOwnProps = any, TStateProps = any, TDispatchProps = any>({ mapStateToProps = () => ({} as TStateProps), mapDispatchToProps = {} as TDispatchProps, component }: ConnectParams<TOwnProps, TStateProps, TDispatchProps>): React.FunctionComponent<TOwnProps> {\r\n\r\n  const Connect = (ownProps: TOwnProps) => {\r\n    const context = useContext(AppContext);\r\n\r\n    const dispatchFuncs = useMemo(() => {\r\n      const dispatchFuncs: { [key: string]: any } = {};\r\n      Object.keys(mapDispatchToProps).forEach((key) => {\r\n        const oldFunc = (mapDispatchToProps as any)[key];\r\n        const newFunc = (...args: any) => {\r\n          const dispatchFunc = oldFunc(...args);\r\n          if (typeof dispatchFunc === 'object') {\r\n            context.dispatch(dispatchFunc);\r\n          } else {\r\n            const result = dispatchFunc(context.dispatch)\r\n            if (typeof result === 'object' && result.then) {\r\n              result.then((dispatchObject?: DispatchObject) => {\r\n                if (dispatchObject && dispatchObject.type) {\r\n                  context.dispatch(dispatchObject);\r\n                }\r\n              })\r\n            }\r\n          }\r\n        }\r\n        dispatchFuncs[key] = newFunc\r\n      });\r\n      return dispatchFuncs;\r\n      // eslint-disable-next-line\r\n    }, [mapDispatchToProps])\r\n\r\n\r\n    const props = useMemo(() => {\r\n      return Object.assign({}, ownProps, mapStateToProps(context.state, ownProps), dispatchFuncs);\r\n      // eslint-disable-next-line\r\n    }, [ownProps, context.state]);\r\n\r\n    return React.createElement<TOwnProps>(component, props);\r\n  }\r\n  return React.memo(Connect as any);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}