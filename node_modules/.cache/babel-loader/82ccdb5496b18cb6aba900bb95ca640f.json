{"ast":null,"code":"import { Plugins } from '@capacitor/core';\nconst {\n  Storage\n} = Plugins;\nconst dataUrl = '/assets/data/data.json';\nconst HAS_LOGGED_IN = 'hasLoggedIn';\nconst HAS_SEEN_TUTORIAL = 'hasSeenTutorial';\nconst USERNAME = 'username'; //const [data type AppState, setData] = useState(false);\n\nconsole.log(\"début\");\nexport const getAppData = async () => {\n  console.log(\"debut lecture du fichier data.json\");\n  const response = await Promise.all([fetch(dataUrl)]);\n  console.log(response);\n  console.log(\"fin lecture du fichier data.json\");\n  console.log(\"debut fetch data.json\");\n  const responseData = await response[0].json();\n  console.log(\"fin fetch data.json\");\n  console.log(responseData);\n  console.log(\"debut fetch event structure\");\n  const propheticmessage = responseData.PropheticMessage;\n  const verseoftoday = responseData.VerseOfToday;\n  const events = responseData.Event;\n  const teachings = responseData.Teaching;\n  const shopping = responseData.Shopping;\n  const lesson_teaching = responseData.Teaching;\n  console.log(lesson_teaching.length);\n  console.log('lessondata');\n  console.log(lesson_teaching);\n  const shoppingitems = parseShoppingItems(shopping);\n  const lessons = parseLessons(teachings);\n  console.log('parsinglessons');\n  console.log(lessons[0]);\n  console.log(\"fin fetch event structure\");\n  const data = {\n    propheticmessage,\n    verseoftoday,\n    events,\n    shopping,\n    shoppingitems,\n    teachings,\n    lessons\n  };\n  console.log(data);\n  console.log(\"fin reading data\");\n  return data;\n};\n\nfunction parseLessons(teachings) {\n  const lessons = [];\n  teachings.forEach(g => {\n    console.log(g);\n    g.lessons.forEach(s => lessons.push(s));\n  });\n  console.log(\"lessons\");\n  console.log(lessons);\n  return lessons;\n}\n\nfunction parseShoppingItems(shopping) {\n  const items = [];\n  shopping.forEach(g => {\n    console.log(g);\n    g.items.forEach(s => items.push(s));\n  });\n  console.log(items);\n  return items;\n}\n\nexport const loadAppData = () => async dispatch => {\n  console.log(\"debut loading data\");\n  dispatch(setLoading(true));\n  const data = await getAppData();\n  console.log(\"fin loading data\");\n  console.log(\"local storage data - setdata\");\n  dispatch(setData(data));\n  dispatch(setLoading(false));\n  console.log(\"fin set data\");\n};\nexport const setLoading = isLoading => ({\n  type: 'set-app-loading',\n  isLoading\n});\nexport const setData = data => ({\n  type: 'set-app-data',\n  data\n});\nexport const getUserData = async () => {\n  const response = await Promise.all([Storage.get({\n    key: HAS_LOGGED_IN\n  }), Storage.get({\n    key: HAS_SEEN_TUTORIAL\n  }), Storage.get({\n    key: USERNAME\n  })]);\n  const isLoggedin = (await response[0].value) === 'true';\n  const hasSeenTutorial = (await response[1].value) === 'true';\n  const username = (await response[2].value) || undefined;\n  const data = {\n    isLoggedin,\n    hasSeenTutorial,\n    username\n  };\n  return data;\n};\nexport const setIsLoggedInData = async isLoggedIn => {\n  await Storage.set({\n    key: HAS_LOGGED_IN,\n    value: JSON.stringify(isLoggedIn)\n  });\n};\nexport const setUsernameData = async username => {\n  if (!username) {\n    await Storage.remove({\n      key: USERNAME\n    });\n  } else {\n    await Storage.set({\n      key: USERNAME,\n      value: username\n    });\n  }\n};\nexport const setHasSeenTutorialData = async hasSeenTutorial => {\n  await Storage.set({\n    key: HAS_SEEN_TUTORIAL,\n    value: JSON.stringify(hasSeenTutorial)\n  });\n};","map":{"version":3,"sources":["/Users/elyotech/Downloads/v9/src/data/dataApi.ts"],"names":["Plugins","Storage","dataUrl","HAS_LOGGED_IN","HAS_SEEN_TUTORIAL","USERNAME","console","log","getAppData","response","Promise","all","fetch","responseData","json","propheticmessage","PropheticMessage","verseoftoday","VerseOfToday","events","Event","teachings","Teaching","shopping","Shopping","lesson_teaching","length","shoppingitems","parseShoppingItems","lessons","parseLessons","data","forEach","g","s","push","items","loadAppData","dispatch","setLoading","setData","isLoading","type","getUserData","get","key","isLoggedin","value","hasSeenTutorial","username","undefined","setIsLoggedInData","isLoggedIn","set","JSON","stringify","setUsernameData","remove","setHasSeenTutorialData"],"mappings":"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","sourcesContent":["import { Plugins } from '@capacitor/core';\r\nimport { useState } from 'react';\r\n\r\nimport { ActionType } from './types'; \r\nimport { AppIfcmState, Event, Shopping, ShoppingItem, Teaching, TeachingLesson, PropheticMessage, VerseOfToday } from './models';\r\n\r\n\r\nconst { Storage } = Plugins;\r\n\r\n\r\nconst dataUrl = '/assets/data/data.json';\r\n\r\nconst HAS_LOGGED_IN = 'hasLoggedIn';\r\nconst HAS_SEEN_TUTORIAL = 'hasSeenTutorial';\r\nconst USERNAME = 'username';\r\n\r\n//const [data type AppState, setData] = useState(false);\r\nconsole.log(\"début\");\r\n\r\nexport const getAppData = async () => {\r\n\r\n  console.log(\"debut lecture du fichier data.json\");\r\n\r\n  const response = await Promise.all([\r\n    fetch(dataUrl)]);\r\n\r\n  console.log(response);\r\n\r\n  console.log(\"fin lecture du fichier data.json\");\r\n\r\n\r\n  console.log(\"debut fetch data.json\");\r\n  const responseData = await response[0].json();\r\n  console.log(\"fin fetch data.json\");\r\n\r\n  console.log(responseData);\r\n\r\n\r\n  console.log(\"debut fetch event structure\");\r\n  const propheticmessage = responseData.PropheticMessage as PropheticMessage;\r\n  const verseoftoday = responseData.VerseOfToday as VerseOfToday;\r\n\r\n  const events = responseData.Event as Event[];\r\n  const teachings = responseData.Teaching as Teaching [];\r\n  const shopping = responseData.Shopping as Shopping [];\r\n  const lesson_teaching = responseData.Teaching as Teaching [];\r\nconsole.log(lesson_teaching.length)\r\nconsole.log('lessondata')\r\n console.log(lesson_teaching)\r\n  const shoppingitems = parseShoppingItems(shopping);\r\n  const lessons = parseLessons(teachings);\r\n  console.log('parsinglessons')\r\n  console.log(lessons[0])\r\n\r\n  console.log(\"fin fetch event structure\");\r\n\r\n  const data = {\r\n    propheticmessage,\r\n    verseoftoday,\r\n    events,\r\n    shopping,\r\n    shoppingitems,\r\n    teachings,\r\n    lessons\r\n  }\r\n\r\n  console.log(data);\r\n\r\n  console.log(\"fin reading data\");\r\n\r\n  return data;\r\n}\r\n\r\n\r\nfunction parseLessons(teachings: Teaching[]) {\r\n  const lessons: TeachingLesson[] = [];\r\n  teachings.forEach(g => {\r\n      console.log(g);\r\n      g.lessons.forEach(s => lessons.push(s))\r\n   });\r\n   console.log(\"lessons\");\r\n  console.log(lessons); \r\n\r\n  return lessons;\r\n}\r\n\r\n\r\nfunction parseShoppingItems(shopping: Shopping[]) {\r\n  const items: ShoppingItem[] = [];\r\n  shopping.forEach(g => {\r\n      console.log(g);\r\n      g.items.forEach(s => items.push(s))\r\n  });\r\n  console.log(items); \r\n\r\n  return items;\r\n}\r\n\r\n  export const loadAppData = () => async (dispatch: React.Dispatch<any>) => {\r\n\r\n    console.log(\"debut loading data\");\r\n    dispatch(setLoading(true));\r\n    const data = await getAppData();\r\n    console.log(\"fin loading data\");\r\n    \r\n    console.log(\"local storage data - setdata\");\r\n    dispatch(setData(data));\r\n    dispatch(setLoading(false));\r\n    console.log(\"fin set data\");\r\n\r\n  }\r\n\r\nexport const setLoading = (isLoading: boolean) => ({\r\n  type: 'set-app-loading',\r\n  isLoading\r\n} as const);\r\n\r\nexport const setData = (data: Partial<AppIfcmState>) => ({\r\n  type: 'set-app-data',\r\n  data\r\n} as const);\r\n\r\nexport type SessionsActions =\r\n  | ActionType<typeof setLoading>\r\n  | ActionType<typeof setData>\r\n\r\n\r\n  export const getUserData = async () => {\r\n    const response = await Promise.all([\r\n      Storage.get({ key: HAS_LOGGED_IN }),\r\n      Storage.get({ key: HAS_SEEN_TUTORIAL }),\r\n      Storage.get({ key: USERNAME })]);\r\n    const isLoggedin = await response[0].value === 'true';\r\n    const hasSeenTutorial = await response[1].value === 'true';\r\n    const username = await response[2].value || undefined;\r\n    const data = {\r\n      isLoggedin,\r\n      hasSeenTutorial,\r\n      username\r\n    }\r\n    return data;\r\n  }\r\n  \r\n  export const setIsLoggedInData = async (isLoggedIn: boolean) => {\r\n    await Storage.set({ key: HAS_LOGGED_IN, value: JSON.stringify(isLoggedIn) });\r\n  }\r\n\r\n  export const setUsernameData = async (username?: string) => {\r\n    if (!username) {\r\n      await Storage.remove({ key: USERNAME });\r\n    } else {\r\n      await Storage.set({ key: USERNAME, value: username });\r\n    }\r\n  }\r\n\r\n  export const setHasSeenTutorialData = async (hasSeenTutorial: boolean) => {\r\n    await Storage.set({ key: HAS_SEEN_TUTORIAL, value: JSON.stringify(hasSeenTutorial) });\r\n  }\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}